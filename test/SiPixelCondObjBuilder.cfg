process PEDESTALS = {

  # MessageLogger
  include "FWCore/MessageService/data/MessageLogger.cfi"

#  source = EmptySource { untracked int32 maxEvents = 1 untracked uint32 firstRun = 1 untracked uint32 numberEventsInRun = 1 }
  source = EmptyIOVSource { string timetype = "runnumber" untracked uint32 firstRun = 1 untracked uint32 lastRun = 1 uint32 interval = 1 }

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  # Gain Calibration Service
  include "CondTools/SiPixel/data/SiPixelGainCalibrationService.cfi"

  module SiPixelCondObjBuilder= SiPixelCondObjBuilder {

    # Max number of detector modules (whole detector > 1500)
	 int32  numberOfModules = 2000
    # Append DataBase payload to existing file
         untracked bool   appendMode = false
    # DB record name
      string record= "SiPixelGainCalibrationRcd"
    # Calibration from input file or random number generator
	 bool   fromFile = false
	 string fileName = "../macros/phCalibrationFit_C0.dat"
    # Parameters for random number generator
	 double meanPed  = 100.0
	 double rmsPed   =   5.0
         double meanGain =  25.0
	 double rmsGain  =   5.0

	using SiPixelGainCalibrationServiceParameters
  }

  
  #include "CondCore/DBCommon/data/CondDBCommon.cfi"
  #replace CondDBCommon.connect = "sqlite_file:prova.db"
  #replace CondDBCommon.catalog = "file:prova_dbcatalog.xml"

  service = PoolDBOutputService {
    string timetype = "runnumber"
    string connect = "sqlite_file:prova.db"
    untracked string catalog = "xmlcatalog_file:prova_dbcatalog.xml"
    VPSet toPut={ {string record= "SiPixelGainCalibrationRcd" string tag ="mytest_p"} } 
    PSet DBParameters = { 
	untracked string authenticationPath = "./"  
	untracked int32 messageLevel = 1
	untracked bool loadBlobStreamer = true
	}
  }

  path p = { SiPixelCondObjBuilder }

  module print = AsciiOutputModule {}
  endpath ep = { print }
}
